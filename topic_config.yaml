# Konfigurace pro MQTT topic zpracování
# Každý topic může mít vlastní strategii zpracování

topics:
  # VP_counter_01 - Čítač kusů
  "tovarna/vp_counter_01/pieces":
    strategy: "counter"  # sčítá hodnoty count ze zpráv
    interval: 60  # interval v sekundách pro odeslání do InfluxDB
    measurement: "vp_counter"
    tags:
      device: "VP_counter_01"
      location: "tovarna"
    field_name: "pieces"  # název fieldu v InfluxDB
    reset_after_send: true  # vynulovat po odeslání

  # Příklad: Jiný čítač s jiným intervalem
  "tovarna/citac/chyby":
    strategy: "counter"
    interval: 300  # 5 minut
    measurement: "citac_chyb"
    tags:
      location: "hala1"
      machine: "citac_01"
    increment_value: 1
    field_name: "error_count"
    reset_after_send: true

  # Příklad: Běžný sensor - okamžité odeslání každé hodnoty
  "tovarna/teplota/senzor1":
    strategy: "immediate"
    measurement: "temperature"
    tags:
      location: "hala1"
      sensor_type: "DHT22"
    field_name: "value"
    unit: "celsius"

  # Příklad: Průměrování hodnot
  "tovarna/teplota/senzor2":
    strategy: "average"
    interval: 120  # každé 2 minuty odešle průměr
    measurement: "temperature_avg"
    tags:
      location: "hala2"
      sensor_type: "DS18B20"
    field_name: "avg_value"
    reset_after_send: true

  # Příklad: Wildcard topic - použije se pro všechny topicy začínající 'sensors/'
  "sensors/#":
    strategy: "immediate"
    measurement: "sensor_data"
    # Tagy se vytvoří automaticky z topic path
    auto_tags: true

# Výchozí konfigurace pro topicy, které nejsou v seznamu
default:
  strategy: "immediate"
  measurement: "mqtt_data"
  auto_tags: true
